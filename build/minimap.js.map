{"version":3,"sources":["webpack:///minimap.js","webpack:///webpack/bootstrap 2b98535b8457dfa9cfbd","webpack:///./src/util/create-map.js","webpack:///./src/lib/grid/getStepSizes.js","webpack:///./src/lib/grid/GridDataLoader.js","webpack:///./src/lib/minimap.js","webpack:///./~/lodash.throttle/index.js","webpack:///./src/lib/grid/getPixelBounds.js","webpack:///./src/lib/grid/grid-utils.js","webpack:///./src/lib/grid/inBounds.js","webpack:///./src/lib/grid/sampleGrid.js","webpack:///./src/lib/grid/wrapBounds.js","webpack:///./src/minimap.js","webpack:///(webpack)/buildin/global.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","default","onLoad","container","document","createElement","classList","add","body","appendChild","mapboxgl","accessToken","map","Map","center","zoom","style","renderWorldCopies","maxBounds","on","getStepSizes","bbox","height","width","maxX","northeast","longitude","maxY","southwest","latitude","minX","minY","Math","abs","_classCallCheck","instance","Constructor","TypeError","createGeoJsonData","type","features","arguments","length","undefined","_createClass","defineProperties","target","props","descriptor","writable","key","protoProps","staticProps","_gridUtils","gridUtils","obj","newObj","_sampleGrid","_sampleGrid2","cache","GridDataLoader","this","images","options","_this","bounds","samplingFactor","queryGrids","image","url","weatherParameter","_executeQuery","Promise","all","then","gridData","grid","_this2","resolve","reject","_fetchData","imageToBitmap","bitmap","data","imageDataToPixels","catch","error","Image","crossOrigin","addEventListener","src","toRatio","lngLat","xRatio","lng","yRatio","lat","min","max","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","push","err","Array","isArray","Minimap","imageUrl","imageBbox","setupDom","clear","calculateImage","calculateViewport","canvas","nw","se","_toRatio","_toRatio2","lngOrigin","latOrigin","_toRatio3","_toRatio4","lngExpand","latExpand","draw","drawImage","getBounds","northWest","getNorthWest","southEast","getSouthEast","_toRatio5","_toRatio6","_toRatio7","_toRatio8","drawOutline","getContext","clearRect","x","y","context","strokeStyle","lineWidth","strokeRect","global","debounce","func","wait","invokeFunc","time","args","lastArgs","thisArg","lastThis","lastInvokeTime","result","apply","leadingEdge","timerId","setTimeout","timerExpired","leading","remainingWait","timeSinceLastCall","lastCallTime","timeSinceLastInvoke","maxing","nativeMin","maxWait","shouldInvoke","now","trailingEdge","trailing","cancel","clearTimeout","flush","debounced","isInvoking","FUNC_ERROR_TEXT","toNumber","isObject","nativeMax","throttle","isObjectLike","isSymbol","objectToString","symbolTag","NAN","other","valueOf","replace","reTrim","isBinary","reIsBinary","test","reIsOctal","freeParseInt","slice","reIsBadHex","parseInt","freeGlobal","freeSelf","self","root","Function","objectProto","toString","Date","_interopRequireDefault","_toConsumableArray","arr2","from","getPixelExtent","bboxExtent","boundsExtent","bboxInLng","_inBounds","inLng","bboxInLat","inLat","_getStepSizes","_getStepSizes6","_getStepSizes2","stepX","stepY","distLng","distLat","extentX","extentY","floor","getPixelOrigins","bboxOrigin","boundsOrigin","_getStepSizes3","_getStepSizes4","originX","originY","getPixelBounds","wrappedBounds","_wrapBounds2","concat","_getStepSizes5","_wrapBounds","getImageData","imageData","pixels","Uint8Array","len","point","sw","ne","eastBound","westBound","inLong","inBounds","getSamplingRates","zoomScale","pow","samplingRateX","samplingRateY","getProperties","index","weatherParameters","forEach","colorValue","createFeature","coordinates","properties","geometry","sampleGrid","mapState","_ref","geoJsonFeatures","pixelWithParams","lngStep","latStep","_getSamplingRates","_getSamplingRates2","sampleStepX","sampleStepY","_getPixelBounds","_getPixelBounds4","_getPixelBounds2","_getPixelBounds3","wrapLngLat","LngLat","wrap","wrapBounds","_extends","assign","source","convertBounds","mapboxBounds","getSouthWest","getNorthEast","init","loader","_minimap2","_GridDataLoader2","addSource","addLayer","id","paint","circle-color","query","_lodash2","getZoom","queryData","geojson","feature","color","getSource","setData","_createMap","_createMap2","_minimap","_GridDataLoader","_lodash","g","eval","e","window"],"mappings":"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","file":"minimap.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 14);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (onLoad) {\n  var container = document.createElement('div');\n  container.classList.add('map', 'container');\n\n  document.body.appendChild(container);\n\n  mapboxgl.accessToken = 'pk.eyJ1Ijoic2NhcnlzaXplIiwiYSI6ImNpcjR2ZWs4ODAwNDZoc25xMmRzM2JlcnQifQ.XmRVjMqDm9jUWw3eMYrrUw';\n\n  var map = new mapboxgl.Map({\n    container: container,\n    center: [0, 0],\n    zoom: 0,\n    style: 'mapbox://styles/scarysize/cj318x12u00002qnqcawqy98r',\n    renderWorldCopies: false,\n    maxBounds: [[-180, -85], [180, 85]]\n  });\n\n  map.on('load', function () {\n    return onLoad(map);\n  });\n};\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = getStepSizes;\n/**\n * Calculate the step size for calculating pixel coordinates to lat/lng coords.\n * @param  {object} bbox  The bounding box\n * @param  {number} height  -\n * @param  {number} width  -\n * @return {object}  The step sizes: {stepX: <number>, stepY: <number>}\n */\nfunction getStepSizes(bbox, height, width) {\n  var maxX = bbox.northeast.longitude;\n  var maxY = bbox.southwest.latitude;\n  var minX = bbox.southwest.longitude;\n  var minY = bbox.northeast.latitude;\n\n  return [Math.abs(minX - maxX) / width, Math.abs(minY - maxY) / height];\n}\n\n/***/ }),\n/* 2 */,\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _gridUtils = __webpack_require__(10);\n\nvar gridUtils = _interopRequireWildcard(_gridUtils);\n\nvar _sampleGrid = __webpack_require__(12);\n\nvar _sampleGrid2 = _interopRequireDefault(_sampleGrid);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Creates a valid GeoJSON FeatureCollection from an array of features.\n * @param  {array} features  The features\n * @return {object}  The GeoJSON FeatureCollection\n * @private\n */\nfunction createGeoJsonData() {\n  var features = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n  return {\n    type: 'FeatureCollection',\n    features: features\n  };\n}\n\nvar cache = {};\n\n/**\n * A data loader to fetch images and convert them to grids.\n */\n\nvar GridDataLoader = function () {\n  function GridDataLoader() {\n    _classCallCheck(this, GridDataLoader);\n  }\n\n  _createClass(GridDataLoader, [{\n    key: 'queryData',\n\n    /**\n     * Queries grid data.\n     * @param  {object} metaData  The metadata for the query\n     * @param  {QueryOptions} options  The query options\n     * @return {Promise.<object>}  A Promise which resolves with GeoJSON data\n     *   sampled from the grid\n     */\n    value: function queryData(images, options) {\n      var _this = this;\n\n      var bbox = options.bbox,\n          bounds = options.bounds,\n          samplingFactor = options.samplingFactor,\n          zoom = options.zoom;\n\n\n      var queryGrids = images.map(function (image) {\n        var url = image.url,\n            weatherParameter = image.weatherParameter;\n\n        var queryGrid = _this._executeQuery(url, weatherParameter);\n\n        return queryGrid;\n      });\n\n      return Promise.all(queryGrids).then(function (gridData) {\n        var features = (0, _sampleGrid2.default)({\n          grid: gridData,\n          bbox: bbox\n        }, {\n          bounds: bounds,\n          zoom: zoom\n        }, samplingFactor);\n\n        return features;\n      }).then(createGeoJsonData);\n    }\n\n    /**\n     * Queries the grid data for a given url.\n     * @param  {string} url  The url for the grid image\n     * @param  {string} weatherParameter  The name of the weather parameter\n     *   represented by the grid\n     * @return {Promise.<object>}  The grid\n     * @private\n     */\n\n  }, {\n    key: '_executeQuery',\n    value: function _executeQuery(url, weatherParameter) {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this2._fetchData(url)\n        // convert the image Image to ImageData\n        .then(gridUtils.imageToBitmap)\n        // convert ImageData to grid object\n        .then(function (bitmap) {\n          return {\n            data: gridUtils.imageDataToPixels(bitmap),\n            height: bitmap.height,\n            width: bitmap.width,\n            weatherParameter: weatherParameter\n          };\n        })\n        // cache the grid and return it\n        .then(resolve).catch(function (error) {\n          return reject(error);\n        });\n      });\n    }\n\n    /**\n     * Fetches an Image from either cache or network.\n     * @param  {string} url  The image url\n     * @return {Promise.<Image>}  The image\n     */\n\n  }, {\n    key: '_fetchData',\n    value: function _fetchData(url) {\n      if (cache[url]) {\n        return Promise.resolve(cache[url]);\n      }\n\n      return new Promise(function (resolve, reject) {\n        var image = new Image();\n        image.crossOrigin = 'anonymous';\n\n        image.addEventListener('error', reject);\n        image.addEventListener('load', function () {\n          cache[url] = image;\n          resolve(image);\n        });\n\n        image.src = url;\n      });\n    }\n  }]);\n\n  return GridDataLoader;\n}();\n\n/**\n * The options used to query data\n * @typedef {object} QueryOptions\n * @property {object} bounds  The current map bounding box\n * @property {boolean} shouldSample  Indicate if the the grid should be sampled\n *   even if the timestamp did not change\n * @property {number} lastTimestamp  The last timestamp of the timeseries which\n *   was queried\n * @property {number} referenceTime  The current time to query for\n * @property {number} samplingFactor  The factor used for sampling the grid\n * @property {number} zoom  The current map zoom\n */\n\n\nexports.default = GridDataLoader;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MAX_LNG = 360;\nvar MAX_LAT = 180;\nvar MAX_X = 500;\nvar MAX_Y = 500;\n\nfunction toRatio(lngLat) {\n  var xRatio = (lngLat.lng + 180) / 360;\n  var yRatio = (90 - lngLat.lat) / 180;\n\n  return [Math.min(Math.max(xRatio, 0), 100), Math.min(Math.max(yRatio, 0), 100)];\n}\n\nvar cache = {};\n\nvar Minimap = function () {\n  function Minimap(map, imageUrl, imageBbox) {\n    var _this = this;\n\n    _classCallCheck(this, Minimap);\n\n    this.map = map;\n    this.imageUrl = imageUrl;\n    this.imageBbox = imageBbox;\n\n    this.setupDom();\n    this.map.on('move', function () {\n      _this.clear();\n      _this.calculateImage();\n      _this.calculateViewport();\n    });\n\n    this.calculateImage();\n    this.calculateViewport();\n  }\n\n  _createClass(Minimap, [{\n    key: 'setupDom',\n    value: function setupDom() {\n      this.container = document.createElement('div');\n      this.canvas = document.createElement('canvas');\n      this.canvas.width = MAX_X;\n      this.canvas.height = MAX_Y;\n\n      this.container.classList.add('container');\n      this.container.appendChild(this.canvas);\n      document.body.appendChild(this.container);\n    }\n  }, {\n    key: 'calculateImage',\n    value: function calculateImage() {\n      var _this2 = this;\n\n      var url = this.imageUrl;\n      var bbox = this.imageBbox;\n      var nw = { lng: bbox.southwest.longitude, lat: bbox.northeast.latitude };\n      var se = { lng: bbox.northeast.longitude, lat: bbox.southwest.latitude };\n\n      var _toRatio = toRatio(nw),\n          _toRatio2 = _slicedToArray(_toRatio, 2),\n          lngOrigin = _toRatio2[0],\n          latOrigin = _toRatio2[1];\n\n      var _toRatio3 = toRatio(se),\n          _toRatio4 = _slicedToArray(_toRatio3, 2),\n          lngExpand = _toRatio4[0],\n          latExpand = _toRatio4[1];\n\n      var width = (lngExpand - lngOrigin) * MAX_X;\n      var height = (latExpand - latOrigin) * MAX_Y;\n\n      var draw = function draw(image) {\n        return _this2.drawImage(image, MAX_X * lngOrigin, MAX_Y * latOrigin, width, height);\n      };\n\n      if (cache[url]) {\n        draw(cache[url]);\n        return;\n      }\n\n      var image = new Image(url);\n      image.addEventListener('load', function () {\n        cache[url] = image;\n        draw(image);\n      });\n\n      image.src = url;\n    }\n  }, {\n    key: 'calculateViewport',\n    value: function calculateViewport() {\n      var bounds = this.map.getBounds();\n      var northWest = bounds.getNorthWest();\n      var southEast = bounds.getSouthEast();\n\n      var _toRatio5 = toRatio(northWest),\n          _toRatio6 = _slicedToArray(_toRatio5, 2),\n          lngOrigin = _toRatio6[0],\n          latOrigin = _toRatio6[1];\n\n      var _toRatio7 = toRatio(southEast),\n          _toRatio8 = _slicedToArray(_toRatio7, 2),\n          lngExpand = _toRatio8[0],\n          latExpand = _toRatio8[1];\n\n      var width = (lngExpand - lngOrigin) * MAX_X;\n      var height = (latExpand - latOrigin) * MAX_Y;\n\n      this.drawOutline(MAX_X * lngOrigin, MAX_Y * latOrigin, width, height);\n    }\n  }, {\n    key: 'clear',\n    value: function clear() {\n      this.canvas.getContext('2d').clearRect(0, 0, MAX_X, MAX_Y);\n    }\n  }, {\n    key: 'drawImage',\n    value: function drawImage(image, x, y, width, height) {\n      var context = this.canvas.getContext('2d');\n\n      context.drawImage(image, x, y, width, height);\n    }\n  }, {\n    key: 'drawOutline',\n    value: function drawOutline(x, y, width, height) {\n      var context = this.canvas.getContext('2d');\n\n      context.strokeStyle = 'rgba(255, 0, 0, 0.7)';\n      context.lineWidth = 7;\n      context.strokeRect(x, y, width, height);\n    }\n  }]);\n\n  return Minimap;\n}();\n\nexports.default = Minimap;\n\n/***/ }),\n/* 5 */,\n/* 6 */,\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(17)))\n\n/***/ }),\n/* 8 */,\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nexports.getPixelExtent = getPixelExtent;\nexports.getPixelOrigins = getPixelOrigins;\nexports.default = getPixelBounds;\n\nvar _getStepSizes5 = __webpack_require__(1);\n\nvar _getStepSizes6 = _interopRequireDefault(_getStepSizes5);\n\nvar _inBounds = __webpack_require__(11);\n\nvar _wrapBounds = __webpack_require__(13);\n\nvar _wrapBounds2 = _interopRequireDefault(_wrapBounds);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/**\n * Calculates the maximum extent which needs to be sampled from the grid.\n * @param  {object} bbox  The bounding box of the grid\n * @param  {object} bounds  The current map bounds\n * @param  {number} height  The pixel height of the grid\n * @param  {number} width  The pixel width of the grid\n * @return {number[]}  The extent: [<max-x>, <max-y>]\n */\nfunction getPixelExtent(bbox, bounds, height, width) {\n  var bboxExtent = {\n    lng: bbox.northeast.longitude,\n    lat: bbox.southwest.latitude\n  };\n  var boundsExtent = {\n    lng: bounds.northeast.lng,\n    lat: bounds.southwest.lat\n  };\n  var bboxInLng = (0, _inBounds.inLng)(bboxExtent, bounds);\n  var bboxInLat = (0, _inBounds.inLat)(bboxExtent, bounds);\n\n  var _getStepSizes = (0, _getStepSizes6.default)(bbox, height, width),\n      _getStepSizes2 = _slicedToArray(_getStepSizes, 2),\n      stepX = _getStepSizes2[0],\n      stepY = _getStepSizes2[1];\n\n  var distLng = Math.abs(bboxExtent.lng - boundsExtent.lng);\n  var distLat = Math.abs(bboxExtent.lat - boundsExtent.lat);\n\n  var extentX = width;\n  var extentY = height;\n\n  if (!bboxInLng) {\n    extentX = extentX - Math.floor(distLng / stepX);\n  }\n\n  if (!bboxInLat) {\n    extentY = extentY - Math.floor(distLat / stepY);\n  }\n\n  return [extentX, extentY];\n}\n\n/**\n * Calculates the starting coordinates for the grid sampling.\n * @param  {object} bbox  The bounding box of the grid\n * @param  {object} bounds  The current map bounds\n * @param  {number} height  The pixel height of the grid\n * @param  {number} width  The pixel width of the grid\n * @return {number[]}  The origin: [<min-x>, <min-y>]\n */\nfunction getPixelOrigins(bbox, bounds, height, width) {\n  var bboxOrigin = {\n    lng: bbox.southwest.longitude,\n    lat: bbox.northeast.latitude\n  };\n  var boundsOrigin = {\n    lng: bounds.southwest.lng,\n    lat: bounds.northeast.lat\n  };\n  var bboxInLng = (0, _inBounds.inLng)(bboxOrigin, bounds);\n  var bboxInLat = (0, _inBounds.inLat)(bboxOrigin, bounds);\n\n  var _getStepSizes3 = (0, _getStepSizes6.default)(bbox, height, width),\n      _getStepSizes4 = _slicedToArray(_getStepSizes3, 2),\n      stepX = _getStepSizes4[0],\n      stepY = _getStepSizes4[1];\n\n  var distLng = Math.abs(bboxOrigin.lng - boundsOrigin.lng);\n  var distLat = Math.abs(bboxOrigin.lat - boundsOrigin.lat);\n\n  var originX = 0;\n  var originY = 0;\n\n  if (!bboxInLng) {\n    originX = Math.floor(distLng / stepX);\n  }\n\n  if (!bboxInLat) {\n    originY = Math.floor(distLat / stepY);\n  }\n\n  return [originX, originY];\n}\n\n/**\n * Calculates the bounds of the grid area which needs to be sampled.\n * @param  {object} bbox  The bounding box of the grid\n * @param  {object} bounds  The current map bounds\n * @param  {number} height  The pixel height of the grid\n * @param  {number} width  The pixel width of the grid\n * @return {array[]}  The bounds: [<min-x>, <min-y>, <max-x>, <max-y>]\n */\nfunction getPixelBounds(bbox, bounds, height, width) {\n  if (Math.abs(bounds.southwest.lng - bounds.northeast.lng) >= 360) {\n    return [0, 0, width, height];\n  }\n\n  var wrappedBounds = (0, _wrapBounds2.default)(bounds);\n  return [].concat(_toConsumableArray(getPixelOrigins(bbox, wrappedBounds, height, width)), _toConsumableArray(getPixelExtent(bbox, wrappedBounds, height, width)));\n}\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.imageToBitmap = imageToBitmap;\nexports.imageDataToPixels = imageDataToPixels;\n/**\n * Generates the raw image data from a given Image element.\n * @param  {Image} image  The image\n * @return {ImageData}  -\n */\nfunction getImageData(image) {\n  var canvas = document.createElement('canvas');\n  canvas.height = image.height;\n  canvas.width = image.width;\n\n  var context = canvas.getContext('2d');\n\n  context.drawImage(image, 0, 0);\n\n  return context.getImageData(0, 0, image.width, image.height);\n}\n\n/**\n * Converts an Image to ImageData.\n * @param  {Image} image  The image\n * @return {ImageData}  The converted image\n */\nfunction imageToBitmap(image) {\n  return Promise.resolve(getImageData(image));\n}\n\n/**\n * Retrieves the single grey scale values from image data.\n * @param  {ImageData} imageData  -\n * @return {Uint8Array}  Containing 1 grey value per pixel\n */\nfunction imageDataToPixels(imageData) {\n  var data = imageData.data;\n  var height = imageData.height,\n      width = imageData.width;\n\n  var pixels = new Uint8Array(height * width);\n\n  for (var i = 0, len = data.length; i < len; i += 4) {\n    pixels[i / 4] = data[i];\n  }\n\n  return pixels;\n}\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.inLat = inLat;\nexports.inLng = inLng;\nexports.default = inBounds;\n/**\n * Check if a point is located in the latitude range of a given bounding box.\n * @param  {object} point  -\n * @param  {object} bounds  -\n * @return {boolean}  True if inside of the latitude range\n */\nfunction inLat(point, bounds) {\n  var sw = bounds.southwest;\n  var ne = bounds.northeast;\n\n  return point.lat > sw.lat && point.lat < ne.lat;\n}\n\n/**\n * Check if a point is located in the longitude range of a given bounding box.\n * @param  {object} point  -\n * @param  {object} bounds  -\n * @return {boolean}  True if inside of the longitude range\n */\nfunction inLng(point, bounds) {\n  var sw = bounds.southwest;\n  var ne = bounds.northeast;\n  var eastBound = point.lng < ne.lng;\n  var westBound = point.lng > sw.lng;\n\n  var inLong = eastBound && westBound;\n  if (ne.lng < sw.lng) {\n    inLong = eastBound || westBound;\n  }\n\n  return inLong;\n}\n\n/**\n * Checks if a point is located in a given bounding box.\n * @param  {object} point  -\n * @param  {object} bounds  -\n * @return {boolean}  True if inside of the bounding box\n */\nfunction inBounds(point, bounds) {\n  return inLat(point, bounds) && inLng(point, bounds);\n}\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nexports.default = sampleGrid;\n\nvar _getPixelBounds3 = __webpack_require__(9);\n\nvar _getPixelBounds4 = _interopRequireDefault(_getPixelBounds3);\n\nvar _getStepSizes3 = __webpack_require__(1);\n\nvar _getStepSizes4 = _interopRequireDefault(_getStepSizes3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/**\n * Creates a default value map with 0..254 entries.\n * @return {array.<number>}  The value map\n */\nfunction getDefaultValueMap() {\n  var valueMap = [];\n  for (var i = 0; i < 255; i++) {\n    valueMap.push(i);\n  }\n\n  return valueMap;\n}\n\n/**\n * Calculates the sampling rates in x and y direction based on the grid\n *  dimensions and the zoom level.\n * @param  {number} height  Grid height\n * @param  {number} width  Grid width\n * @param  {number} zoom  Current zoom value\n * @param  {number} samplingFactor  The configurable sampling factor\n * @return {array.<number>}  The sampling rates: [x, y]\n */\nfunction getSamplingRates(height, width, zoom, samplingFactor) {\n  var zoomScale = Math.pow(2, Math.floor(zoom));\n\n  var samplingRateX = Math.floor(1 / (zoomScale * samplingFactor) * width);\n  var samplingRateY = Math.floor(1 / (zoomScale * samplingFactor) * height);\n\n  return [Math.max(samplingRateX, 1), Math.max(samplingRateY, 1)];\n}\n\n/**\n * Creates the GeoJSON properties object by looking up the weather parameters\n *   from multiple grids.\n * @param  {array.<object>} gridData  The grids\n * @param  {number} index  The index to of the pixel to look up (1D)\n * @param  {object} valueMappingTables  The value mappings for every weather\n *   parameter.\n * @return {object}  The GeoJSON properties object\n */\nfunction getProperties(gridData, index) {\n  var weatherParameters = {};\n  gridData.forEach(function (grid) {\n    var colorValue = grid.data[index];\n\n    weatherParameters[grid.weatherParameter] = colorValue;\n  });\n\n  return {\n    weatherParameters: weatherParameters\n  };\n}\n\n/**\n * Creates a point feature from coordinates and properties.\n * @param  {array} coordinates  [lng, lat]\n * @param  {object} properties  -\n * @return {object}  A valid GeoJSON Point Feature\n */\nfunction createFeature(coordinates, properties) {\n  return {\n    type: 'Feature',\n    geometry: {\n      type: 'Point',\n      coordinates: coordinates\n    },\n    properties: properties\n  };\n}\n\n/**\n * Samples multiple grids to generate GeoJSON features.\n * @param  {object} gridData  The gridData\n *   @param  {array.<object>} gridData.grid  Multiple pixel grids\n *   @param  {object} gridData.bbox  The bounding box of the the grids\n * @param  {object} mapState  -\n *   @param  {object} mapState.bounds  The current map bounds\n *   @param  {number} mapState.zoom  The current (floored) map zoom\n * @param  {number} samplingFactor  The configurable sampling factor\n * @return  {array.<object>}  An array of GeoJSON features\n */\nfunction sampleGrid(gridData, mapState, samplingFactor) {\n  var _ref;\n\n  var bbox = gridData.bbox,\n      grid = gridData.grid;\n  var bounds = mapState.bounds,\n      zoom = mapState.zoom;\n\n\n  var geoJsonFeatures = grid.map(function (pixelWithParams) {\n    var height = pixelWithParams.height,\n        width = pixelWithParams.width;\n\n    var _getStepSizes = (0, _getStepSizes4.default)(bbox, height, width),\n        _getStepSizes2 = _slicedToArray(_getStepSizes, 2),\n        lngStep = _getStepSizes2[0],\n        latStep = _getStepSizes2[1];\n\n    var _getSamplingRates = getSamplingRates(height, width, zoom, samplingFactor),\n        _getSamplingRates2 = _slicedToArray(_getSamplingRates, 2),\n        sampleStepX = _getSamplingRates2[0],\n        sampleStepY = _getSamplingRates2[1];\n\n    var _getPixelBounds = (0, _getPixelBounds4.default)(bbox, bounds, height, width),\n        _getPixelBounds2 = _slicedToArray(_getPixelBounds, 4),\n        originX = _getPixelBounds2[0],\n        originY = _getPixelBounds2[1],\n        extentX = _getPixelBounds2[2],\n        extentY = _getPixelBounds2[3];\n\n    var minX = originX - originX % sampleStepX;\n    var minY = originY - originY % sampleStepY;\n\n    var features = [];\n    for (var y = minY; y < extentY; y += sampleStepY) {\n      for (var x = minX; x < extentX; x += sampleStepX) {\n        var lat = bbox.northeast.latitude - y * latStep;\n        var lng = bbox.southwest.longitude + x * lngStep;\n\n        var properties = getProperties(grid, x + y * width // the index into the 1D pixel array\n        );\n\n        features.push(createFeature([lng, lat], properties));\n      }\n    }\n\n    return features;\n  });\n\n  return (_ref = []).concat.apply(_ref, _toConsumableArray(geoJsonFeatures));\n}\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = wrapBounds;\n/**\n * Wraps a given point into -180..180 longitude range.\n * @param  {object} point  -\n *   @param {number}  point.lat  -\n *   @param {number}  point.lng  -\n * @return {object}  The wrapped point\n */\nfunction wrapLngLat(point) {\n  var lngLat = new mapboxgl.LngLat(point.lng, point.lat).wrap();\n\n  return {\n    lat: lngLat.lat,\n    lng: lngLat.lng\n  };\n}\n\n/**\n * Wraps northeast and southwest coords of bounds into -180..180 longitude\n *   range.\n * @param  {object} bounds  -\n * @return {object}  The wrapped bounds\n */\nfunction wrapBounds(bounds) {\n  return {\n    northeast: _extends({}, wrapLngLat(bounds.northeast)),\n    southwest: _extends({}, wrapLngLat(bounds.southwest))\n  };\n}\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createMap = __webpack_require__(0);\n\nvar _createMap2 = _interopRequireDefault(_createMap);\n\nvar _minimap = __webpack_require__(4);\n\nvar _minimap2 = _interopRequireDefault(_minimap);\n\nvar _GridDataLoader = __webpack_require__(3);\n\nvar _GridDataLoader2 = _interopRequireDefault(_GridDataLoader);\n\nvar _lodash = __webpack_require__(7);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n(0, _createMap2.default)(init);\n\nfunction convertBounds(mapboxBounds) {\n  var sw = mapboxBounds.getSouthWest();\n  var ne = mapboxBounds.getNorthEast();\n\n  return {\n    southwest: { lng: sw.lng, lat: sw.lat },\n    northeast: { lng: ne.lng, lat: ne.lat }\n  };\n}\n\nvar bbox = {\n  northeast: { latitude: 52.05249047600099, longitude: 86.8359375 },\n  southwest: { latitude: -52.908902047770255, longitude: -39.0234375 }\n};\nvar url = 'foo.png';\n\nfunction init(map) {\n  var minimap = new _minimap2.default(map, 'foo.png', bbox);\n  var loader = new _GridDataLoader2.default();\n\n  map.addSource('circle-source', {\n    type: 'geojson',\n    data: {\n      type: 'FeatureCollection',\n      features: []\n    }\n  });\n  map.addLayer({\n    type: 'circle',\n    source: 'circle-source',\n    id: 'circle-layer',\n    paint: {\n      'circle-color': {\n        type: 'identity',\n        property: 'color'\n      }\n    }\n  });\n\n  var query = (0, _lodash2.default)(function () {\n    var options = {\n      bbox: bbox,\n      bounds: convertBounds(map.getBounds()),\n      samplingFactor: 12,\n      zoom: Math.floor(map.getZoom())\n    };\n\n    loader.queryData([{ url: url, weatherParameter: 'color' }], options).then(function (geojson) {\n      for (var i = 0; i < geojson.features.length; i++) {\n        var feature = geojson.features[i];\n        var color = feature.properties.weatherParameters.color;\n\n\n        if (color > 0) {\n          feature.properties.color = '#42f448';\n        } else {\n          feature.properties.color = '#000000';\n        }\n      }\n\n      map.getSource('circle-source').setData(geojson);\n    });\n  }, 100);\n\n  map.on('move', query);\n}\n\n/***/ }),\n/* 15 */,\n/* 16 */,\n/* 17 */\n/***/ (function(module, exports) {\n\nvar g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// minimap.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2b98535b8457dfa9cfbd","export default function(onLoad) {\n  const container = document.createElement('div');\n  container.classList.add('map', 'container');\n\n  document.body.appendChild(container);\n\n  mapboxgl.accessToken =\n    'pk.eyJ1Ijoic2NhcnlzaXplIiwiYSI6ImNpcjR2ZWs4ODAwNDZoc25xMmRzM2JlcnQifQ.XmRVjMqDm9jUWw3eMYrrUw';\n\n  const map = new mapboxgl.Map({\n    container,\n    center: [0, 0],\n    zoom: 0,\n    style: 'mapbox://styles/scarysize/cj318x12u00002qnqcawqy98r',\n    renderWorldCopies: false,\n    maxBounds: [[-180, -85], [180, 85]]\n  });\n\n  map.on('load', () => onLoad(map));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/create-map.js","/**\n * Calculate the step size for calculating pixel coordinates to lat/lng coords.\n * @param  {object} bbox  The bounding box\n * @param  {number} height  -\n * @param  {number} width  -\n * @return {object}  The step sizes: {stepX: <number>, stepY: <number>}\n */\nexport default function getStepSizes(bbox, height, width) {\n  const maxX = bbox.northeast.longitude;\n  const maxY = bbox.southwest.latitude;\n  const minX = bbox.southwest.longitude;\n  const minY = bbox.northeast.latitude;\n\n  return [Math.abs(minX - maxX) / width, Math.abs(minY - maxY) / height];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/grid/getStepSizes.js","import * as gridUtils from './grid-utils';\nimport sampleGrid from './sampleGrid';\n\n/**\n * Creates a valid GeoJSON FeatureCollection from an array of features.\n * @param  {array} features  The features\n * @return {object}  The GeoJSON FeatureCollection\n * @private\n */\nfunction createGeoJsonData(features = []) {\n  return {\n    type: 'FeatureCollection',\n    features\n  };\n}\n\nconst cache = {};\n\n/**\n * A data loader to fetch images and convert them to grids.\n */\nexport default class GridDataLoader {\n  /**\n   * Queries grid data.\n   * @param  {object} metaData  The metadata for the query\n   * @param  {QueryOptions} options  The query options\n   * @return {Promise.<object>}  A Promise which resolves with GeoJSON data\n   *   sampled from the grid\n   */\n  queryData(images, options) {\n    const {bbox, bounds, samplingFactor, zoom} = options;\n\n    const queryGrids = images.map(image => {\n      const {url, weatherParameter} = image;\n      const queryGrid = this._executeQuery(url, weatherParameter);\n\n      return queryGrid;\n    });\n\n    return Promise.all(queryGrids)\n      .then(gridData => {\n        const features = sampleGrid(\n          {\n            grid: gridData,\n            bbox\n          },\n          {\n            bounds,\n            zoom\n          },\n          samplingFactor\n        );\n\n        return features;\n      })\n      .then(createGeoJsonData);\n  }\n\n  /**\n   * Queries the grid data for a given url.\n   * @param  {string} url  The url for the grid image\n   * @param  {string} weatherParameter  The name of the weather parameter\n   *   represented by the grid\n   * @return {Promise.<object>}  The grid\n   * @private\n   */\n  _executeQuery(url, weatherParameter) {\n    return new Promise((resolve, reject) => {\n      this._fetchData(url)\n        // convert the image Image to ImageData\n        .then(gridUtils.imageToBitmap)\n        // convert ImageData to grid object\n        .then(bitmap => ({\n          data: gridUtils.imageDataToPixels(bitmap),\n          height: bitmap.height,\n          width: bitmap.width,\n          weatherParameter\n        }))\n        // cache the grid and return it\n        .then(resolve)\n        .catch(error => reject(error));\n    });\n  }\n\n  /**\n   * Fetches an Image from either cache or network.\n   * @param  {string} url  The image url\n   * @return {Promise.<Image>}  The image\n   */\n  _fetchData(url) {\n    if (cache[url]) {\n      return Promise.resolve(cache[url]);\n    }\n\n    return new Promise((resolve, reject) => {\n      const image = new Image();\n      image.crossOrigin = 'anonymous';\n\n      image.addEventListener('error', reject);\n      image.addEventListener('load', () => {\n        cache[url] = image;\n        resolve(image);\n      });\n\n      image.src = url;\n    });\n  }\n}\n\n/**\n * The options used to query data\n * @typedef {object} QueryOptions\n * @property {object} bounds  The current map bounding box\n * @property {boolean} shouldSample  Indicate if the the grid should be sampled\n *   even if the timestamp did not change\n * @property {number} lastTimestamp  The last timestamp of the timeseries which\n *   was queried\n * @property {number} referenceTime  The current time to query for\n * @property {number} samplingFactor  The factor used for sampling the grid\n * @property {number} zoom  The current map zoom\n */\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/grid/GridDataLoader.js","const MAX_LNG = 360;\nconst MAX_LAT = 180;\nconst MAX_X = 500;\nconst MAX_Y = 500;\n\nfunction toRatio(lngLat) {\n  const xRatio = (lngLat.lng + 180) / 360;\n  const yRatio = (90 - lngLat.lat) / 180;\n\n  return [\n    Math.min(Math.max(xRatio, 0), 100),\n    Math.min(Math.max(yRatio, 0), 100)\n  ];\n}\n\nconst cache = {};\n\nexport default class Minimap {\n  constructor(map, imageUrl, imageBbox) {\n    this.map = map;\n    this.imageUrl = imageUrl;\n    this.imageBbox = imageBbox;\n\n    this.setupDom();\n    this.map.on('move', () => {\n      this.clear();\n      this.calculateImage();\n      this.calculateViewport();\n    });\n\n    this.calculateImage();\n    this.calculateViewport();\n  }\n\n  setupDom() {\n    this.container = document.createElement('div');\n    this.canvas = document.createElement('canvas');\n    this.canvas.width = MAX_X;\n    this.canvas.height = MAX_Y;\n\n    this.container.classList.add('container');\n    this.container.appendChild(this.canvas);\n    document.body.appendChild(this.container);\n  }\n\n  calculateImage() {\n    const url = this.imageUrl;\n    const bbox = this.imageBbox;\n    const nw = {lng: bbox.southwest.longitude, lat: bbox.northeast.latitude};\n    const se = {lng: bbox.northeast.longitude, lat: bbox.southwest.latitude};\n    const [lngOrigin, latOrigin] = toRatio(nw);\n    const [lngExpand, latExpand] = toRatio(se);\n    const width = (lngExpand - lngOrigin) * MAX_X;\n    const height = (latExpand - latOrigin) * MAX_Y;\n\n    const draw = image =>\n      this.drawImage(\n        image,\n        MAX_X * lngOrigin,\n        MAX_Y * latOrigin,\n        width,\n        height\n      );\n\n    if (cache[url]) {\n      draw(cache[url]);\n      return;\n    }\n\n    const image = new Image(url);\n    image.addEventListener('load', () => {\n      cache[url] = image;\n      draw(image);\n    });\n\n    image.src = url;\n  }\n\n  calculateViewport() {\n    const bounds = this.map.getBounds();\n    const northWest = bounds.getNorthWest();\n    const southEast = bounds.getSouthEast();\n    const [lngOrigin, latOrigin] = toRatio(northWest);\n    const [lngExpand, latExpand] = toRatio(southEast);\n    const width = (lngExpand - lngOrigin) * MAX_X;\n    const height = (latExpand - latOrigin) * MAX_Y;\n\n    this.drawOutline(MAX_X * lngOrigin, MAX_Y * latOrigin, width, height);\n  }\n\n  clear() {\n    this.canvas.getContext('2d').clearRect(0, 0, MAX_X, MAX_Y);\n  }\n\n  drawImage(image, x, y, width, height) {\n    const context = this.canvas.getContext('2d');\n\n    context.drawImage(image, x, y, width, height);\n  }\n\n  drawOutline(x, y, width, height) {\n    const context = this.canvas.getContext('2d');\n\n    context.strokeStyle = 'rgba(255, 0, 0, 0.7)';\n    context.lineWidth = 7;\n    context.strokeRect(x, y, width, height);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/minimap.js","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/lodash.throttle/index.js\n// module id = 7\n// module chunks = 0","import getStepSizes from './getStepSizes';\nimport {inLng, inLat} from './inBounds';\nimport wrapBounds from './wrapBounds';\n\n/**\n * Calculates the maximum extent which needs to be sampled from the grid.\n * @param  {object} bbox  The bounding box of the grid\n * @param  {object} bounds  The current map bounds\n * @param  {number} height  The pixel height of the grid\n * @param  {number} width  The pixel width of the grid\n * @return {number[]}  The extent: [<max-x>, <max-y>]\n */\nexport function getPixelExtent(bbox, bounds, height, width) {\n  const bboxExtent = {\n    lng: bbox.northeast.longitude,\n    lat: bbox.southwest.latitude\n  };\n  const boundsExtent = {\n    lng: bounds.northeast.lng,\n    lat: bounds.southwest.lat\n  };\n  const bboxInLng = inLng(bboxExtent, bounds);\n  const bboxInLat = inLat(bboxExtent, bounds);\n  const [stepX, stepY] = getStepSizes(bbox, height, width);\n  const distLng = Math.abs(bboxExtent.lng - boundsExtent.lng);\n  const distLat = Math.abs(bboxExtent.lat - boundsExtent.lat);\n\n  let extentX = width;\n  let extentY = height;\n\n  if (!bboxInLng) {\n    extentX = extentX - Math.floor(distLng / stepX);\n  }\n\n  if (!bboxInLat) {\n    extentY = extentY - Math.floor(distLat / stepY);\n  }\n\n  return [extentX, extentY];\n}\n\n/**\n * Calculates the starting coordinates for the grid sampling.\n * @param  {object} bbox  The bounding box of the grid\n * @param  {object} bounds  The current map bounds\n * @param  {number} height  The pixel height of the grid\n * @param  {number} width  The pixel width of the grid\n * @return {number[]}  The origin: [<min-x>, <min-y>]\n */\nexport function getPixelOrigins(bbox, bounds, height, width) {\n  const bboxOrigin = {\n    lng: bbox.southwest.longitude,\n    lat: bbox.northeast.latitude\n  };\n  const boundsOrigin = {\n    lng: bounds.southwest.lng,\n    lat: bounds.northeast.lat\n  };\n  const bboxInLng = inLng(bboxOrigin, bounds);\n  const bboxInLat = inLat(bboxOrigin, bounds);\n  const [stepX, stepY] = getStepSizes(bbox, height, width);\n  const distLng = Math.abs(bboxOrigin.lng - boundsOrigin.lng);\n  const distLat = Math.abs(bboxOrigin.lat - boundsOrigin.lat);\n\n  let originX = 0;\n  let originY = 0;\n\n  if (!bboxInLng) {\n    originX = Math.floor(distLng / stepX);\n  }\n\n  if (!bboxInLat) {\n    originY = Math.floor(distLat / stepY);\n  }\n\n  return [originX, originY];\n}\n\n/**\n * Calculates the bounds of the grid area which needs to be sampled.\n * @param  {object} bbox  The bounding box of the grid\n * @param  {object} bounds  The current map bounds\n * @param  {number} height  The pixel height of the grid\n * @param  {number} width  The pixel width of the grid\n * @return {array[]}  The bounds: [<min-x>, <min-y>, <max-x>, <max-y>]\n */\nexport default function getPixelBounds(bbox, bounds, height, width) {\n  if (Math.abs(bounds.southwest.lng - bounds.northeast.lng) >= 360) {\n    return [0, 0, width, height];\n  }\n\n  const wrappedBounds = wrapBounds(bounds);\n  return [\n    ...getPixelOrigins(bbox, wrappedBounds, height, width),\n    ...getPixelExtent(bbox, wrappedBounds, height, width)\n  ];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/grid/getPixelBounds.js","/**\n * Generates the raw image data from a given Image element.\n * @param  {Image} image  The image\n * @return {ImageData}  -\n */\nfunction getImageData(image) {\n  const canvas = document.createElement('canvas');\n  canvas.height = image.height;\n  canvas.width = image.width;\n\n  const context = canvas.getContext('2d');\n\n  context.drawImage(image, 0, 0);\n\n  return context.getImageData(0, 0, image.width, image.height);\n}\n\n/**\n * Converts an Image to ImageData.\n * @param  {Image} image  The image\n * @return {ImageData}  The converted image\n */\nexport function imageToBitmap(image) {\n  return Promise.resolve(getImageData(image));\n}\n\n/**\n * Retrieves the single grey scale values from image data.\n * @param  {ImageData} imageData  -\n * @return {Uint8Array}  Containing 1 grey value per pixel\n */\nexport function imageDataToPixels(imageData) {\n  const {data} = imageData;\n  const {height, width} = imageData;\n  const pixels = new Uint8Array(height * width);\n\n  for (let i = 0, len = data.length; i < len; i += 4) {\n    pixels[i / 4] = data[i];\n  }\n\n  return pixels;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/grid/grid-utils.js","/**\n * Check if a point is located in the latitude range of a given bounding box.\n * @param  {object} point  -\n * @param  {object} bounds  -\n * @return {boolean}  True if inside of the latitude range\n */\nexport function inLat(point, bounds) {\n  const sw = bounds.southwest;\n  const ne = bounds.northeast;\n\n  return point.lat > sw.lat && point.lat < ne.lat;\n}\n\n/**\n * Check if a point is located in the longitude range of a given bounding box.\n * @param  {object} point  -\n * @param  {object} bounds  -\n * @return {boolean}  True if inside of the longitude range\n */\nexport function inLng(point, bounds) {\n  const sw = bounds.southwest;\n  const ne = bounds.northeast;\n  const eastBound = point.lng < ne.lng;\n  const westBound = point.lng > sw.lng;\n\n  let inLong = eastBound && westBound;\n  if (ne.lng < sw.lng) {\n    inLong = eastBound || westBound;\n  }\n\n  return inLong;\n}\n\n/**\n * Checks if a point is located in a given bounding box.\n * @param  {object} point  -\n * @param  {object} bounds  -\n * @return {boolean}  True if inside of the bounding box\n */\nexport default function inBounds(point, bounds) {\n  return inLat(point, bounds) && inLng(point, bounds);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/grid/inBounds.js","import getPixelBounds from './getPixelBounds';\nimport getStepSizes from './getStepSizes';\n\n/**\n * Creates a default value map with 0..254 entries.\n * @return {array.<number>}  The value map\n */\nfunction getDefaultValueMap() {\n  const valueMap = [];\n  for (let i = 0; i < 255; i++) {\n    valueMap.push(i);\n  }\n\n  return valueMap;\n}\n\n/**\n * Calculates the sampling rates in x and y direction based on the grid\n *  dimensions and the zoom level.\n * @param  {number} height  Grid height\n * @param  {number} width  Grid width\n * @param  {number} zoom  Current zoom value\n * @param  {number} samplingFactor  The configurable sampling factor\n * @return {array.<number>}  The sampling rates: [x, y]\n */\nfunction getSamplingRates(height, width, zoom, samplingFactor) {\n  const zoomScale = Math.pow(2, Math.floor(zoom));\n\n  const samplingRateX = Math.floor(1 / (zoomScale * samplingFactor) * width);\n  const samplingRateY = Math.floor(1 / (zoomScale * samplingFactor) * height);\n\n  return [Math.max(samplingRateX, 1), Math.max(samplingRateY, 1)];\n}\n\n/**\n * Creates the GeoJSON properties object by looking up the weather parameters\n *   from multiple grids.\n * @param  {array.<object>} gridData  The grids\n * @param  {number} index  The index to of the pixel to look up (1D)\n * @param  {object} valueMappingTables  The value mappings for every weather\n *   parameter.\n * @return {object}  The GeoJSON properties object\n */\nfunction getProperties(gridData, index) {\n  const weatherParameters = {};\n  gridData.forEach(grid => {\n    const colorValue = grid.data[index];\n\n    weatherParameters[grid.weatherParameter] = colorValue;\n  });\n\n  return {\n    weatherParameters\n  };\n}\n\n/**\n * Creates a point feature from coordinates and properties.\n * @param  {array} coordinates  [lng, lat]\n * @param  {object} properties  -\n * @return {object}  A valid GeoJSON Point Feature\n */\nfunction createFeature(coordinates, properties) {\n  return {\n    type: 'Feature',\n    geometry: {\n      type: 'Point',\n      coordinates\n    },\n    properties\n  };\n}\n\n/**\n * Samples multiple grids to generate GeoJSON features.\n * @param  {object} gridData  The gridData\n *   @param  {array.<object>} gridData.grid  Multiple pixel grids\n *   @param  {object} gridData.bbox  The bounding box of the the grids\n * @param  {object} mapState  -\n *   @param  {object} mapState.bounds  The current map bounds\n *   @param  {number} mapState.zoom  The current (floored) map zoom\n * @param  {number} samplingFactor  The configurable sampling factor\n * @return  {array.<object>}  An array of GeoJSON features\n */\nexport default function sampleGrid(gridData, mapState, samplingFactor) {\n  const {bbox, grid} = gridData;\n  const {bounds, zoom} = mapState;\n\n  const geoJsonFeatures = grid.map(pixelWithParams => {\n    const {height, width} = pixelWithParams;\n\n    const [lngStep, latStep] = getStepSizes(bbox, height, width);\n    const [sampleStepX, sampleStepY] = getSamplingRates(\n      height,\n      width,\n      zoom,\n      samplingFactor\n    );\n\n    const [originX, originY, extentX, extentY] = getPixelBounds(\n      bbox,\n      bounds,\n      height,\n      width\n    );\n    const minX = originX - originX % sampleStepX;\n    const minY = originY - originY % sampleStepY;\n\n    const features = [];\n    for (let y = minY; y < extentY; y += sampleStepY) {\n      for (let x = minX; x < extentX; x += sampleStepX) {\n        const lat = bbox.northeast.latitude - y * latStep;\n        const lng = bbox.southwest.longitude + x * lngStep;\n\n        const properties = getProperties(\n          grid,\n          x + y * width // the index into the 1D pixel array\n        );\n\n        features.push(createFeature([lng, lat], properties));\n      }\n    }\n\n    return features;\n  });\n\n  return [].concat(...geoJsonFeatures);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/grid/sampleGrid.js","/**\n * Wraps a given point into -180..180 longitude range.\n * @param  {object} point  -\n *   @param {number}  point.lat  -\n *   @param {number}  point.lng  -\n * @return {object}  The wrapped point\n */\nfunction wrapLngLat(point) {\n  const lngLat = new mapboxgl.LngLat(point.lng, point.lat).wrap();\n\n  return {\n    lat: lngLat.lat,\n    lng: lngLat.lng\n  };\n}\n\n/**\n * Wraps northeast and southwest coords of bounds into -180..180 longitude\n *   range.\n * @param  {object} bounds  -\n * @return {object}  The wrapped bounds\n */\nexport default function wrapBounds(bounds) {\n  return {\n    northeast: {\n      ...wrapLngLat(bounds.northeast)\n    },\n    southwest: {\n      ...wrapLngLat(bounds.southwest)\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/grid/wrapBounds.js","import createMap from './util/create-map';\nimport Minimap from './lib/minimap';\nimport GridDataLoader from './lib/grid/GridDataLoader.js';\nimport throttle from 'lodash.throttle';\n\ncreateMap(init);\n\nfunction convertBounds(mapboxBounds) {\n  const sw = mapboxBounds.getSouthWest();\n  const ne = mapboxBounds.getNorthEast();\n\n  return {\n    southwest: {lng: sw.lng, lat: sw.lat},\n    northeast: {lng: ne.lng, lat: ne.lat}\n  };\n}\n\nconst bbox = {\n  northeast: {latitude: 52.05249047600099, longitude: 86.8359375},\n  southwest: {latitude: -52.908902047770255, longitude: -39.0234375}\n};\nconst url = 'foo.png';\n\nfunction init(map) {\n  const minimap = new Minimap(map, 'foo.png', bbox);\n  const loader = new GridDataLoader();\n\n  map.addSource('circle-source', {\n    type: 'geojson',\n    data: {\n      type: 'FeatureCollection',\n      features: []\n    }\n  });\n  map.addLayer({\n    type: 'circle',\n    source: 'circle-source',\n    id: 'circle-layer',\n    paint: {\n      'circle-color': {\n        type: 'identity',\n        property: 'color'\n      }\n    }\n  });\n\n  const query = throttle(() => {\n    const options = {\n      bbox,\n      bounds: convertBounds(map.getBounds()),\n      samplingFactor: 12,\n      zoom: Math.floor(map.getZoom())\n    };\n\n    loader\n      .queryData([{url, weatherParameter: 'color'}], options)\n      .then(geojson => {\n        for (let i = 0; i < geojson.features.length; i++) {\n          const feature = geojson.features[i];\n          const {color} = feature.properties.weatherParameters;\n\n          if (color > 0) {\n            feature.properties.color = '#42f448';\n          } else {\n            feature.properties.color = '#000000';\n          }\n        }\n\n        map.getSource('circle-source').setData(geojson);\n      });\n  }, 100);\n\n  map.on('move', query);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/minimap.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 17\n// module chunks = 0"],"sourceRoot":""}